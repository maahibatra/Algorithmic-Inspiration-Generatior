<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generated Ideas</title>
</head>
<body>
    <div class="header">
        <div class="title">AIG - Output</div>
        <button class="headerButton" onclick="window.location.href='index.html'">Home</button>
        <button class="headerButton" onclick="window.location.href='saved.html'">Saved</button>
        <button onclick="saveSelected()" class="headerButton">Save Selected Ideas</button>
    </div>

    <div id="inputPrompt"></div>
    <div id="generatedIdeasList"></div>

    <script>
        let generatedIdeas = [];

        function loadGeneratedIdeas() {
            const inputPrompt = document.getElementById('inputPrompt');
            const generatedIdeasList = document.getElementById('generatedIdeasList');

            const storedPrompt = localStorage.getItem('inputPrompt');
            inputPrompt.innerHTML = `<strong>Input Prompt:</strong> ${storedPrompt}`;

            if (storedPrompt) {
                fetch('http://localhost:5000/api/generate-ideas', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ prompt: storedPrompt })
                })
                .then(response => response.json())
                .then(data => {
                    if (Array.isArray(data) && data.length > 0) {
                        generatedIdeas = data;
                        generatedIdeasList.innerHTML = data.map((idea, index) => `
                            <div>
                                <input type="checkbox" id="idea-${index}" value="${idea}">
                                <label for="idea-${index}">${idea}</label>
                            </div>
                        `).join('');
                    } else {
                        generatedIdeasList.innerHTML = "No ideas available.";
                    }
                })
                .catch(error => {
                    generatedIdeasList.innerHTML = "An error occurred while generating ideas.";
                    console.error(error);
                });
            } else {
                generatedIdeasList.innerHTML = "No input prompt found.";
            }
        }

        function saveSelected() {
            const selectedIdeas = [];
            generatedIdeas.forEach((idea, index) => {
                const checkbox = document.getElementById(`idea-${index}`);
                if (checkbox && checkbox.checked) {
                    selectedIdeas.push(idea);
                }
            });

            if (selectedIdeas.length > 0) {
                const savedIdeas = JSON.parse(localStorage.getItem('savedIdeas')) || [];
                savedIdeas.push(...selectedIdeas);
                localStorage.setItem('savedIdeas', JSON.stringify(savedIdeas));
                alert("Selected ideas saved!");
            } else {
                alert("Please select at least one idea to save.");
            }
        }

        window.onload = loadGeneratedIdeas;
    </script>
</body>
</html>
